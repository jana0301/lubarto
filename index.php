<?php

?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>PHP Translate Content Parset - Test</title>
    <script src='https://cdn.tinymce.com/4/tinymce.min.js' referrerpolicy="origin"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700,900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <style>
        .container {
            max-width: 1240px;
        }
        code {
            white-space: pre-wrap;
        }
    </style>
</head>
<body style="font-family: 'Lato', sans-serif;">
    <div class="container">
        <h1 class="mb-3 mt-3"><small>Translate service HTML Content Parser - Sandbox</small></h1>
        <hr/>
    </div>
    <div class="container mb-3">
        <div class="row">
            <div class="col-md-6 clearfix">
                <form method="post">
                    <textarea id="rich-text-editor" rows="25">
                        <p><strong>CARNIVAL Info</strong></p><p>If you or your business would like to donate goods or services see <a href="https://docs.google.com/forms/d/1QfeBGK2EJhPO1x_2OQpeXpNt7pWPbQx1ycxkjaHWOIE/viewform?edit_requested=true" data-mce-href="https://docs.google.com/forms/d/1QfeBGK2EJhPO1x_2OQpeXpNt7pWPbQx1ycxkjaHWOIE/viewform?edit_requested=true">Donation Form link</a> <strong>due 9/5/19</strong>. Huge Thank you to our local businesses who support our fundraising efforts! &nbsp; PTA membership helps local/state/national policies for our kids/teachers/schools, &amp; Edith Bowen Teachers &amp; Families.</p><p><img src="https://irp-cdn.multiscreensite.com/ea0e3cf4/dms3rep/multi/mobile/HIGH+RES+NEW+LOGO+LONG_newcolor1-2cd6391a.png" alt="" width="423" height="80" style="display: block; margin-left: auto; margin-right: auto;" data-mce-style="display: block; margin-left: auto; margin-right: auto;"><br data-mce-bogus="1"></p><h3 style="text-align: center;" data-mce-style="text-align: center;"><em>Service opportunity during Carnival</em>&nbsp;</h3><p>Collecting items for Little Lambs non-profit, they provide products to low-income families, comfort kits for foster care, emergency shelters, those escaping domestic violence. Below are items in need (open diapers packages you no longer need are accepted). Each item donated earns 1 carnival ticket, up to 8 tickets per family.</p><p>Collecting items for Little Lambs non-profit, they provide products to low-income families, comfort kits for foster care, emergency shelters, those escaping domestic violence. Below are items in need (open diapers packages you no longer need are accepted). Each item donated earns 1 carnival ticket, up to 8 tickets per family.</p><p><strong>Comfort items</strong></p><ul><li><a data-mce-href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses" href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses">Backpacks/Tote bags</a></li><li><a data-mce-href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses" href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses">Blankets/Quilts</a></li><li><a href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses" data-mce-href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses">Travel Kleenexes</a></li><li><a data-mce-href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses" href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses">Shampoo/Conditioner (hotel samples work great)</a></li><li><a href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses" data-mce-href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses">Feminine products</a></li><li><a data-mce-href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses" href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses">ChapStick</a></li><li><a data-mce-href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses" href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses">Mouthwash</a></li><li><a data-mce-href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses" href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses">Baby hygiene items (baby wash, powder, lotion, diaper rash cream, wipes)</a></li></ul><p><strong>Volunteer Opportunities</strong></p><p>If you would like to help this school year please fill out <a href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses" data-mce-href="https://docs.google.com/forms/d/1kMxG8iw8pZDHM8HFaIHTxA0IxQ3dfoh17UwYdqhdYYE/viewform?edit_requested=true#responses">Volunteer Form link.</a> It has various opportunities to fit many scheduling demands.</p><p>Carnival Help <a title="Carnival Volunteer Link" href="https://docs.google.com/spreadsheets/d/1KvCltnhPzC5RuYwHD8A3Kid4nxAkltzmw4VhZ-8Knek/edit#gid=0" data-mce-href="https://docs.google.com/spreadsheets/d/1KvCltnhPzC5RuYwHD8A3Kid4nxAkltzmw4VhZ-8Knek/edit#gid=0">Carnival Volunteer link</a></p>
                    </textarea>
                </form>
                <select id="lang-target" class="form-control mt-3">
                    <option value="es">Spanish</option>
                    <option value="de">German</option>
                    <option value="pt">Portuguese</option>
                    <option value="ru">Russian</option>
                </select>
                <button id="submit-translate" class="btn btn-primary float-right mt-3 mb-3">Translate</button>
            </div>
            <div class="col-md-6">
                <div id="translated-preview">
                    <div class="card">
                        <div class="card-body" style="max-height: 700px; overflow-y: auto;">
                            <h3 class="mb-0">Translated content</h3>
                            <div class="content-html mt-3" style="font-size: 0.9rem;">No data.</div>
                        </div>
                        <div class="card-footer">
                            <span class="text-muted"><big><b>Translation Statistics</b></big></span>
                            <ul class="list-group list-group-flush mt-3" id="stats-list" style="display: none;">
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Unprocessed input size (with HTML)
                                    <span class="badge badge-danger badge-pill" id="stats1"></span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Textual input size (no HTML)
                                    <span class="badge badge-default badge-pill" id="stats2"></span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    <b>Compressed input size (with HTML)</b>
                                    <span class="badge badge-success badge-pill" id="stats3"></span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Unprocessed input VS Textual input
                                    <span class="badge badge-danger badge-pill" id="stats4"></span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Textual input VS Compressed input
                                    <span class="badge badge-default badge-pill" id="stats5"></span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    <b>Compressed input VS Unprocessed input</b>
                                    <big><span class="badge badge-success badge-pill" id="stats6"></span></big>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="card mt-3">
                    <div class="card-body">
                        <span class="text-muted"><big><b>Processed Data</b></big></span>
                        <div class="mt-3" id="translation-data" style="display: none;">
                            <b>Unprocessed Input</b>
                            <hr/>
                            <small><pre><code id="data-unprocessed-input"></code></pre></small>
                            <b>Compressed Input (sent to Translate service)</b>
                            <hr/>
                            <small><pre><code id="data-compressed-input"></code></pre></small>
                            <b>Markup Blueprint</b>
                            <hr/>
                            <small><pre><code id="data-markup-blueprint"></code></pre></small>
                            <b>Blueprint Return Values</b>
                            <hr/>
                            <small><pre><code id="data-blueprint-values"></code></pre></small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

<script>
    $(document).ready(function() {
        tinymce.init({
            selector: '#rich-text-editor',
            setup: function(ed) {
                ed.on('keyup', function(e) {
                    var originalHTML = ed.getContent();
                    //$('#original-preview .content-html').html(originalHTML);
                });
            },
            plugins: [
                "advlist autolink lists link image charmap print preview anchor",
                "searchreplace visualblocks code fullscreen",
                "insertdatetime media table paste"
            ],
            toolbar: "insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image"
        });

        $('#submit-translate').click(function() {
            var content = tinymce.get('rich-text-editor').getContent();
            console.log(content);
            $.post('source.php', {d: content, target: $('#lang-target').val()})
                .done(function(data) {
                    console.log(data);
                    $('#translated-preview .content-html').html(data.translation);
                    $('#stats-list').css('display', 'block');
                    $('#stats-list #stats1').html(data.stats.raw_input_length);
                    $('#stats-list #stats2').html(data.stats.raw_input_no_html_length);
                    $('#stats-list #stats3').html(data.stats.translation_input_length);
                    $('#stats-list #stats4').html(data.stats.raw_input_no_html_raw_diff + "%");
                    $('#stats-list #stats5').html(data.stats.raw_input_no_html_transl_diff + "%");
                    $('#stats-list #stats6').html(data.stats.raw_input_transl_diff + "%");

                    $.each(data.blueprint_values, function(index, value) {
                        data.blueprint_values[index] = "[" + index + "]" + " => " + value;
                    });

                    $('#translation-data').css('display', 'block');
                    $('#translation-data #data-unprocessed-input').text(data.raw_translation_input);
                    $('#translation-data #data-compressed-input').text(data.translation_input);
                    $('#translation-data #data-markup-blueprint').text(data.blueprint);
                    $('#translation-data #data-blueprint-values').text(JSON.stringify(data.blueprint_values, null, 4));
                })
                .fail(function(xhr, textStatus, errorThrown) {
                    alert(xhr.responseText);
                });
        });
    });
</script>
</html>